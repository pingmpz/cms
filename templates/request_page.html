<!DOCTYPE html>
{% load static %}

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>{{request_no}} | C.C.S. Maintenance Service</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta content="A fully featured admin theme which can be used to build CRM, CMS, etc." name="description" />
        <meta content="Coderthemes" name="author" />
        <!-- App favicon -->
        <link rel="shortcut icon" href="assets/images/favicon.ico">

        <!-- App css -->
        <link href="{% static "assets/css/icons.min.css" %}" rel="stylesheet" type="text/css" />
        <link href="{% static "assets/css/app-modern.min.css" %}" rel="stylesheet" type="text/css" id="light-style" />
        <link href="{% static "assets/css/app-modern-dark.min.css" %}" rel="stylesheet" type="text/css" id="dark-style" />

        <!-- DataTable css -->
        <link href="{% static "assets/css/vendor/dataTables.bootstrap5.css" %}" rel="stylesheet" type="text/css" />
        <link href="{% static "assets/css/vendor/responsive.bootstrap5.css" %}" rel="stylesheet" type="text/css" />
        <link href="{% static "assets/css/vendor/buttons.bootstrap5.css" %}" rel="stylesheet" type="text/css" />
        <link href="{% static "assets/css/vendor/select.bootstrap5.css" %}" rel="stylesheet" type="text/css" />
        <link href="{% static "assets/css/vendor/fixedHeader.bootstrap5.css" %}" rel="stylesheet" type="text/css" />
        <link href="{% static "assets/css/vendor/fixedColumns.bootstrap5.css" %}" rel="stylesheet" type="text/css" />

    </head>

    <body class="loading" data-layout="detached" data-layout-config='{"leftSidebarCondensed":false,"darkMode":false, "showRightSidebarOnStart": false}'>

        <!-- ========== Header Bar ========== -->
        {% include 'header.html' %}

        <div class="container-fluid">
            <div class="wrapper">

                <!-- ========== Left Sidebar ========== -->
                {% include 'sidebar.html' %}

                <!-- ========== Page Content ========== -->
                <div class="content-page">
                    <div class="content">

                        <!-- ========== Inner Top Bar ========== -->
                        <div class="row">
                            <div class="col-12">
                                <div class="page-title-box">
                                    <div class="page-title-right d-flex">

                                    </div>
                                    <h4 class="page-title"><i class="uil-comment-dots"></i> {{request_no}} {% if request.user.is_superuser %}({{req.id}}){% endif %}</h4>
                                </div>
                            </div>
                        </div>

                        {% if requestIsExist %}
                        <!-- ========== Main Content ========== -->
                        <div class="row">

                            <!-- ========== Left Content ========== -->
                            <div class="col-xxl-3 col-lg-6 order-lg-1 order-xxl-1">
                              <input type="text" id="req_id" value="{{req.id}}" hidden>

                              <!-- ========== Pending ========== -->
                              {% if req.status == 'Pending' %}
                              <div class="card bg-warning text-white">
                                  <div class="card-body p-2">
                                      <h3 class="mb-2 mt-2 text-center"><i class='mdi mdi-clock-time-eight-outline'></i> Pending</h3>
                                  </div>
                              </div>
                              {% endif %}

                              <!-- ========== Rejected ========== -->
                              {% if req.status == 'Rejected' %}
                              <div class="card bg-danger text-white">
                                  <div class="card-body p-2">
                                      <h3 class="mb-2 mt-2 text-center"><i class='uil-times'></i> Rejected</h3>
                                      <p class="mb-2 mt-2 text-center">{{req.reason}}</p>
                                  </div>
                              </div>
                              {% endif %}

                              <!-- ========== On Progress ========== -->
                              {% if req.status == 'On Progress' %}
                              <div class="card bg-primary text-white">
                                  <div class="card-body p-2">
                                      <h3 class="mb-2 mt-2 text-center"><i class='uil-play'></i> On Pogress</h3>
                                  </div>
                              </div>
                              {% endif %}

                              <!-- ========== On Hold ========== -->
                              {% if req.status == 'On Hold' %}
                              <div class="card bg-dark text-white">
                                  <div class="card-body p-2">
                                      <h3 class="mb-2 mt-2 text-center"><i class='uil-pause'></i> On Hold</h3>
                                      <p class="mb-2 mt-2 text-center">{{req.reason}}</p>
                                  </div>
                              </div>
                              {% endif %}

                              <!-- ========== Complete ========== -->
                              {% if req.status == 'Complete' %}
                              <div class="card bg-success text-white">
                                  <div class="card-body p-2">
                                      <h3 class="mb-2 mt-2 text-center"><i class='mdi mdi-check-all'></i> Complete</h3>
                                  </div>
                              </div>
                              {% endif %}

                              <!-- ========== Canceled ========== -->
                              {% if req.status == 'Canceled' %}
                              <div class="card bg-danger text-white">
                                  <div class="card-body p-2">
                                      <h3 class="mb-2 mt-2 text-center"><i class='mdi mdi-cancel'></i> Canceled</h3>
                                      <p class="mb-2 mt-2 text-center">{{req.reason}}</p>
                                  </div>
                              </div>
                              {% endif %}

                              {% if req.status != 'Pending' and status != 'Rejected' %}
                              <!-- ========== Request Detail ========== -->
                              <div class="card tilebox-one">
                                  <div class="card-body">
                                      <h6 class="header-title mt-0">Request Detail</h6>
                                      <p class="my-2 small">{{req.description}}</p>
                                      <p class="mb-0 text-nowrap text-muted small">Type: {{req.type}}</p>
                                      <p class="mb-0 text-nowrap text-muted small">Request Date: {{req.request_date}}</p>
                                      <p class="mb-0 text-nowrap text-muted small">Created Date: {{req.date_published}}</p>
                                      <p class="mb-0 text-nowrap text-muted small">Finish Date: {{req.date_modified}}</p>
                                  </div>
                              </div>

                              <!-- ========== Category ========== -->
                              <div class="card">
                                    <div class="card-body">
                                        <div class="dropdown float-end">
                                        </div>
                                        <h4 class="header-title mb-3">Category (2)</h4>

                                        <div class="d-flex mt-2"><i class="mdi mdi-label text-info"></i>&nbsp;&nbsp;&nbsp;Electricity</div>
                                        <div class="d-flex mt-2"><i class="mdi mdi-label text-info"></i>&nbsp;&nbsp;&nbsp;Hydrolic</div>

                                    </div>
                                </div>

                              <!-- ========== Machine ========== -->
                              {% if req.mc %}
                              <div class="card tilebox-one">
                                  <div class="card-body">
                                      <i class="mdi mdi-cogs float-end"></i>
                                      <h6 class="header-title mt-0">Machine</h6>
                                      <h2 class="my-2">&nbsp;&nbsp;&nbsp;{{req.mc.mc_no}}</h2>
                                      <p class="mb-0 text-nowrap text-muted small">Section: {{req.mc.section}}</p>
                                      <p class="mb-0 text-nowrap text-muted small">Register No: {{req.mc.register_no|default_if_none:"-"}}</p>
                                      <p class="mb-0 text-nowrap text-muted small">Asset No: 	{{req.mc.asset_no|default_if_none:"-"}}</p>
                                      <p class="mb-0 text-nowrap text-muted small">Manufacture: {{req.mc.manufacture|default_if_none:"-"}}</p>
                                      <p class="mb-0 text-nowrap text-muted small">Plant: {{req.mc.plant|default_if_none:"-"}}</p>
                                      <p class="mb-0 text-nowrap text-muted small">Model: {{req.mc.model|default_if_none:"-"}}</p>
                                      <p class="mb-0 text-nowrap text-muted small">Serial No: {{req.mc.serial_no|default_if_none:"-"}}</p>
                                      <p class="mb-0 text-nowrap text-muted small">Capacity: {{req.mc.capacity|default_if_none:"-"}}</p>
                                      <p class="mb-0 text-nowrap text-muted small">Power: {{req.mc.power|default_if_none:"-"}}</p>
                                      <p class="mb-0 text-nowrap text-muted small">Install Date: {{req.mc.install_date|default_if_none:"-"}}</p>
                                      <p class="mb-0 text-nowrap text-muted small">Note: {{req.mc.note|default_if_none:"-"}}</p>
                                  </div>
                              </div>
                              {% endif %}

                              <!-- ========== Requester ========== -->
                              <div class="card tilebox-one">
                                  <div class="card-body">
                                      <i class="uil uil-user float-end"></i>
                                      <h6 class="header-title mt-0">Requester</h6>
                                      <h2 class="my-2">&nbsp;&nbsp;&nbsp;{{req.emp_id}}</h2>
                                      <p class="mb-0 text-nowrap text-muted small">{{req.name}} ({{req.section}})</p>
                                      <p class="mb-0 text-nowrap text-muted small">{{req.phone_no}}</p>
                                  </div>
                              </div>
                              {% endif %}

                              <!-- ========== Files ========== -->
                              <div class="card">
                                  <div class="card-body">
                                      <div class="dropdown float-end">
                                      </div>
                                      <h4 class="header-title mb-3">Files (2)</h4>
                                      <div class="card mb-1 shadow-none border">
                                          <div class="p-2">
                                              <div class="row align-items-center">
                                                  <div class="col-auto">
                                                      <div class="avatar-sm">
                                                          <span class="avatar-title rounded">.ZIP</span>
                                                      </div>
                                                  </div>
                                                  <div class="col ps-0">
                                                      <a href="javascript:void(0);" class="text-muted fw-bold">sample.zip</a>
                                                  </div>
                                                  <div class="col-auto">
                                                      <!-- Button -->
                                                      <a href="javascript:void(0);" class="btn btn-link btn-lg text-muted">
                                                          <i class="dripicons-download"></i>
                                                      </a>
                                                  </div>
                                              </div>
                                          </div>
                                      </div>

                                      <div class="card mb-1 shadow-none border">
                                          <div class="p-2">
                                              <div class="row align-items-center">
                                                  <div class="col-auto">
                                                      <div class="avatar-sm">
                                                          <span class="avatar-title rounded">.JPG</span>
                                                      </div>
                                                  </div>
                                                  <div class="col ps-0">
                                                      <a href="javascript:void(0);" class="text-muted fw-bold">image.jpg</a>
                                                  </div>
                                                  <div class="col-auto">
                                                      <!-- Button -->
                                                      <a href="javascript:void(0);" class="btn btn-link btn-lg text-muted">
                                                          <i class="dripicons-download"></i>
                                                      </a>
                                                  </div>
                                              </div>
                                          </div>
                                      </div>

                                  </div>
                              </div>

                            </div>

                            <!-- ========== Middle Content ========== -->
                            <div class="col-xxl-6 col-lg-12 order-lg-2 order-xxl-1">

                                {% if req.status == 'Pending' or req.status == 'Rejected' %}
                                <!-- ========== Request Detail ========== -->
                                <div class="card tilebox-one">
                                    <div class="card-body">
                                        <h6 class="header-title mt-0">Request Detail</h6>
                                        <p class="my-3">{{req.description}}</p>
                                        <p class="mb-0 text-nowrap text-muted small">Type: {{req.type}}</p>
                                        <p class="mb-0 text-nowrap text-muted small">Request Date: {{req.request_date}}</p>
                                        <p class="mb-0 text-nowrap text-muted small">Created Date: {{req.date_published}}</p>
                                        <p class="mb-0 text-nowrap text-muted small">Finish Date: {{req.date_modified}}</p>
                                    </div>
                                </div>

                                <div class="row">
                                  <div class="col-6">
                                    <!-- ========== Requester ========== -->
                                    <div class="card tilebox-one">
                                        <div class="card-body">
                                            <i class="uil uil-user float-end"></i>
                                            <h6 class="header-title mt-0">Requester</h6>
                                            <h2 class="my-2">&nbsp;&nbsp;&nbsp;{{req.emp_id}}</h2>
                                            <p class="mb-0 text-nowrap text-muted small">{{req.name}} ({{req.section}})</p>
                                            <p class="mb-0 text-nowrap text-muted small">{{req.phone_no}}</p>
                                        </div>
                                    </div>
                                  </div>
                                  <div class="col-6">
                                    <!-- ========== Machine ========== -->
                                    {% if req.mc %}
                                    <div class="card tilebox-one">
                                        <div class="card-body">
                                            <i class="mdi mdi-cogs float-end"></i>
                                            <h6 class="header-title mt-0">Machine</h6>
                                            <h2 class="my-2">&nbsp;&nbsp;&nbsp;{{req.mc.mc_no}}</h2>
                                            <p class="mb-0 text-nowrap text-muted small">Section: {{req.mc.section}}</p>
                                            <p class="mb-0 text-nowrap text-muted small">Register No: {{req.mc.register_no|default_if_none:"-"}}</p>
                                            <p class="mb-0 text-nowrap text-muted small">Asset No: 	{{req.mc.asset_no|default_if_none:"-"}}</p>
                                            <p class="mb-0 text-nowrap text-muted small">Manufacture: {{req.mc.manufacture|default_if_none:"-"}}</p>
                                            <p class="mb-0 text-nowrap text-muted small">Plant: {{req.mc.plant|default_if_none:"-"}}</p>
                                            <p class="mb-0 text-nowrap text-muted small">Model: {{req.mc.model|default_if_none:"-"}}</p>
                                            <p class="mb-0 text-nowrap text-muted small">Serial No: {{req.mc.serial_no|default_if_none:"-"}}</p>
                                            <p class="mb-0 text-nowrap text-muted small">Capacity: {{req.mc.capacity|default_if_none:"-"}}</p>
                                            <p class="mb-0 text-nowrap text-muted small">Power: {{req.mc.power|default_if_none:"-"}}</p>
                                            <p class="mb-0 text-nowrap text-muted small">Install Date: {{req.mc.install_date|default_if_none:"-"}}</p>
                                            <p class="mb-0 text-nowrap text-muted small">Note: {{req.mc.note|default_if_none:"-"}}</p>
                                        </div>
                                    </div>
                                    {% endif %}
                                  </div>
                                </div>
                                {% endif %}

                                <!-- ========== Main Tab ========== -->
                                {% if req.status != 'Pending' and req.status != 'Rejected' %}
                                <div class="card">
                                    <div class="card-body">
                                        <ul class="nav nav-pills bg-nav-pills nav-justified mb-3">
                                            <li class="nav-item">
                                                <a href="#comment" data-bs-toggle="tab" aria-expanded="false" class="nav-link active px-3 py-2">
                                                    <i class="mdi mdi-pencil-box-multiple font-18 d-md-none d-block"></i>
                                                    <span class="d-none d-md-block small">Comments</span>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a href="#operate_time" data-bs-toggle="tab" aria-expanded="true" class="nav-link px-3 py-2">
                                                    <i class="mdi mdi-book-open-variant font-18 d-md-none d-block"></i>
                                                    <span class="d-none d-md-block small">Working Time</span>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a href="#mc_downtime" data-bs-toggle="tab" aria-expanded="true" class="nav-link px-3 py-2">
                                                    <i class="mdi mdi-book-open-variant font-18 d-md-none d-block"></i>
                                                    <span class="d-none d-md-block small">Machine Downtime</span>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a href="#costing" data-bs-toggle="tab" aria-expanded="true" class="nav-link px-3 py-2">
                                                    <i class="mdi mdi-book-open-variant font-18 d-md-none d-block"></i>
                                                    <span class="d-none d-md-block small"><del>Costing</del></span>
                                                </a>
                                            </li>
                                        </ul>

                                        <div class="tab-content">
                                            <!-- ========== Comment Tab ========== -->
                                            <div class="tab-pane show active p-0" id="comment">
                                                <!-- ========== New Comment ========== -->
                                                {% if req.status == 'On Progress' or req.status == 'On Hold' %}
                                                {% if isJoined %}
                                                <div class="border rounded">
                                                    <form action="#" class="comment-area-box">
                                                        <textarea rows="4" class="form-control border-0 resize-none" id="comment_text"></textarea>
                                                        <div class="p-2 bg-light d-flex justify-content-between align-items-center">
                                                            <div></div>
                                                            <button type="submit" class="btn btn-sm btn-primary" onclick="post_comment()"><i class='uil uil-message me-1'></i>Post</button>
                                                        </div>
                                                    </form>
                                                </div>
                                                <br>
                                                {% endif %}
                                                {% endif %}
                                                <!-- ========== Comment List ========== -->
                                                <div class="timeline-alt pb-0">

                                                    {% for comment in comments %}
                                                    <div class="timeline-item">
                                                        <i class="mdi mdi-circle bg-primary-lighten text-primary timeline-icon"></i>
                                                        <div class="timeline-item-info">
                                                            <h5 class="mt-0 mb-1">{{comment.user.username}} | {{comment.user.employee.name}}</h5>
                                                            <p class="font-12"><i class="mdi mdi-clock-time-eight-outline"></i> {{comment.date_published}}</span></p>
                                                            <p class="text-muted mt-2 mb-0 pb-3 text-center">{{comment.text}}</p>
                                                            <hr>
                                                        </div>
                                                    </div>
                                                    {% endfor %}

                                                    {% if comments|length == 0 %}
                                                    <div class="timeline-item">
                                                        <h4 class="text-center">There is no comment in this request.</h4>
                                                    </div>
                                                    {% endif %}

                                                </div>
                                            </div>

                                            <!-- ========== Operate Time Tab ========== -->
                                            <div class="tab-pane p-0" id="operate_time">
                                              <ul class="nav nav-pills bg-nav-pills nav-justified mb-3">
                                                  <li class="nav-item">
                                                      <a href="#operators" data-bs-toggle="tab" aria-expanded="false" class="nav-link active">
                                                          <i class="mdi mdi-home-variant d-md-none d-block"></i>
                                                          <span class="d-none d-md-block">Operators</span>
                                                      </a>
                                                  </li>
                                                  <li class="nav-item">
                                                      <a href="#vendors" data-bs-toggle="tab" aria-expanded="true" class="nav-link">
                                                          <i class="mdi mdi-account-circle d-md-none d-block"></i>
                                                          <span class="d-none d-md-block">External Vendors</span>
                                                      </a>
                                                  </li>
                                              </ul>

                                              <!-- ========== Working Time Tab ========== -->
                                              <div class="tab-content">
                                                  <!-- ========== Operator Tab ========== -->
                                                  <div class="tab-pane active" id="operators">
                                                    <!-- ========== Add Operate Time ========== -->
                                                    {% if req.status == 'On Progress' or req.status == 'On Hold' %}
                                                    <p class="text-muted font-12">Use 'CTRL' to select multiple item</p>
                                                    <div class="row">
                                                      <div class="col-10">
                                                        <div class="mb-3">
                                                          <select class="select2 form-control select2-multiple" data-toggle="select2" multiple="multiple" data-placeholder="Choose ...">
                                                              {% for member in members %}
                                                              <option value="{{member.user.username}}">{{member.user.username}} | {{member.user.employee.name}}</option>
                                                              {% endfor %}
                                                          </select>
                                                        </div>
                                                      </div>
                                                      <div class="col-2">
                                                        <div class="mb-3">
                                                          <button type="submit" class="btn btn-sm btn-success"><i class='mdi mdi-content-save me-1'></i>Save</button>
                                                        </div>
                                                      </div>
                                                      <div class="col-6">
                                                        <div class="mb-0">
                                                          <label class="form-label">StartDateTime</label>
                                                          <input type="datetime-local" class="form-control" name="section"  id="operate_start_date_time">
                                                        </div>
                                                      </div>
                                                      <div class="col-6">
                                                        <div class="mb-0">
                                                          <label class="form-label">StopDateTime</label>
                                                          <input type="datetime-local" class="form-control" name="phone_no"  id="operate_stop_date_time">
                                                        </div>
                                                      </div>
                                                    </div>
                                                    <hr>
                                                    {% endif %}
                                                    <!-- ========== Operate Time Table ========== -->
                                                    <table id="operate_time_table" class="table table-sm nowrap dt-responsive row-border order-column w-100 small">
                                                      <thead class="table-light">
                                                          <tr>
                                                              <th>Employee ID</th>
                                                              <th>Name</th>
                                                              <th>StartDateTime</th>
                                                              <th>StopDateTime</th>
                                                          </tr>
                                                      </thead>
                                                      <tbody>
                                                          <tr>
                                                              <td>5731</td>
                                                              <td>Yashawantatul Mangalmurti</td>
                                                              <td>10:51 13/01/2022</td>
                                                              <td>10:51 13/01/2022</td>
                                                          </tr>
                                                          <tr>
                                                              <td>0000</td>
                                                              <td>John</td>
                                                              <td>10:51 13/01/2022</td>
                                                              <td>10:51 13/01/2022</td>
                                                          </tr>
                                                          <tr>
                                                              <td>0001</td>
                                                              <td>David</td>
                                                              <td>10:51 13/01/2022</td>
                                                              <td>10:51 13/01/2022</td>
                                                          </tr>
                                                      </tbody>
                                                    </table>
                                                  </div>

                                                  <!-- ========== Vendors Tab ========== -->
                                                  <div class="tab-pane show" id="vendors">
                                                    <!-- ========== Add Operate Time ========== -->
                                                    {% if req.status == 'On Progress' or req.status == 'On Hold' %}
                                                    <p class="text-muted font-12">Use 'CTRL' to select multiple item</p>
                                                    <div class="row">
                                                      <div class="col-10">
                                                        <div class="mb-3">
                                                          <select class="select2 form-control select2-multiple" data-toggle="select2" multiple="multiple" data-placeholder="Choose ...">
                                                              <option value="10000">10000 | Vendor #1</option>
                                                              <option value="11000">11000 | Vendor #2</option>
                                                              <option value="12000">12000 | Vendor #3</option>
                                                          </select>
                                                        </div>
                                                      </div>
                                                      <div class="col-2">
                                                        <div class="mb-3">
                                                          <button type="submit" class="btn btn-sm btn-success"><i class='mdi mdi-content-save me-1'></i>Save</button>
                                                        </div>
                                                      </div>
                                                      <div class="col-6">
                                                        <div class="mb-0">
                                                          <label class="form-label">StartDateTime</label>
                                                          <input type="datetime-local" class="form-control" name="section"  id="operate_start_date_time">
                                                        </div>
                                                      </div>
                                                      <div class="col-6">
                                                        <div class="mb-0">
                                                          <label class="form-label">StopDateTime</label>
                                                          <input type="datetime-local" class="form-control" name="phone_no"  id="operate_stop_date_time">
                                                        </div>
                                                      </div>
                                                    </div>
                                                    <hr>
                                                    {% endif %}
                                                    <!-- ========== Operate Time Table ========== -->
                                                    <table id="operate_time_table" class="table table-sm nowrap dt-responsive row-border order-column w-100 small">
                                                      <thead class="table-light">
                                                          <tr>
                                                              <th>Vendor Code</th>
                                                              <th>Name</th>
                                                              <th>StartDateTime</th>
                                                              <th>StopDateTime</th>
                                                          </tr>
                                                      </thead>
                                                      <tbody>
                                                          <tr>
                                                              <td>10000</td>
                                                              <td>Vendor #1</td>
                                                              <td>10:51 13/01/2022</td>
                                                              <td>10:51 13/01/2022</td>
                                                          </tr>
                                                      </tbody>
                                                    </table>
                                                  </div>
                                              </div>
                                            </div>

                                            <!-- ========== Machine Downtime Tab ========== -->
                                            <div class="tab-pane p-0" id="mc_downtime">
                                              <!-- ========== Add Machine Downtime ========== -->
                                              {% if req.status == 'On Progress' or req.status == 'On Hold' %}
                                              <div class="row">
                                                <div class="col-10">
                                                  <div class="mb-3">
                                                    <label class="form-label">Machine No</label>
                                                    <input type="text" class="form-control" value="{{req.mc.mc_no}}" readonly>
                                                  </div>
                                                </div>
                                                <div class="col-2">
                                                  <div class="mb-3">
                                                    <label class="form-label">ã…¤</label>
                                                    <button type="submit" class="btn btn-sm btn-success"><i class='mdi mdi-content-save me-1'></i>Save</button>
                                                  </div>
                                                </div>
                                                <div class="col-6">
                                                  <div class="mb-0">
                                                    <label class="form-label">StartDateTime</label>
                                                    <input type="datetime-local" class="form-control" name="section"  id="operate_start_date_time">
                                                  </div>
                                                </div>
                                                <div class="col-6">
                                                  <div class="mb-0">
                                                    <label class="form-label">StopDateTime</label>
                                                    <input type="datetime-local" class="form-control" name="phone_no"  id="operate_stop_date_time">
                                                  </div>
                                                </div>
                                              </div>
                                              <hr>
                                              {% endif %}
                                              <!-- ========== Operate Time Table ========== -->
                                              <table id="operate_time_table" class="table table-sm nowrap dt-responsive row-border order-column w-100 small">
                                                <thead class="table-light">
                                                    <tr>
                                                        <th>StartDateTime</th>
                                                        <th>StopDateTime</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>10:51 13/01/2022</td>
                                                        <td>10:51 13/01/2022</td>
                                                    </tr>
                                                </tbody>
                                              </table>
                                            </div>

                                            <!-- ========== Costing Tab ========== -->
                                            <div class="tab-pane p-3" id="costing">
                                              <div class="timeline-item">
                                                  <h4 class="text-center">This function is on development.</h4>
                                              </div>
                                            </div>

                                        </div>

                                    </div>
                                </div>
                                {% endif %}

                            </div>

                            <!-- ========== Right Content ========== -->
                            <div class="col-xxl-3 col-lg-6 order-lg-1 order-xxl-2">
                                <!-- ========== Functions ========== -->
                                <div class="card">
                                    <div class="card-body p-3">
                                        <div class="dropdown float-end">
                                        </div>
                                        <h4 class="header-title mb-3">Functions</h4>
                                        <div class="list-group list-group-flush my-2">

                                            {% if req.status == 'Pending' %}
                                            <button type="button" class="btn btn-xs mb-1 btn-success"><i class='uil-check me-1'></i>Accept</button>
                                            <button type="button" class="btn btn-xs mb-1 btn-danger"><i class='uil-times me-1'></i>Reject</button>
                                            {% elif req.status == 'On Hold' and not isJoined %}
                                            <button type="button" class="btn btn-xs mb-1 btn-outline-success" onclick="join_request()"><i class='uil-sign-in-alt me-1'></i>Join</button>
                                            {% elif req.status == 'On Hold' %}
                                            <button type="button" class="btn btn-xs mb-1 btn-warning"><i class='uil-pen me-1'></i>Edit Request</button>
                                            <button type="button" class="btn btn-xs mb-1 btn-info"><i class='uil-users-alt me-1'></i>Manage Member</button>
                                            <button type="button" class="btn btn-xs mb-1 btn-primary"><i class='uil-play me-1'></i>Start Work</button>
                                            <button type="button" class="btn btn-xs mb-1 btn-danger"><i class='mdi mdi-cancel me-1'></i>Cancel</button>
                                              {% if members|length > 1 %}
                                              <hr>
                                              <button type="button" class="btn btn-xs mb-1 btn-outline-danger" onclick="leave_request()"><i class='uil-sign-out-alt me-1'></i>Leave</button>
                                              {% endif %}
                                            {% elif req.status == 'On Progress' and not isJoined %}
                                            <button type="button" class="btn btn-xs mb-1 btn-outline-success" onclick="join_request()"><i class='uil-sign-in-alt me-1'></i>Join</button>
                                            {% elif req.status == 'On Progress' %}
                                            <button type="button" class="btn btn-xs mb-1 btn-warning"><i class='uil-pen me-1'></i>Edit Request</button>
                                            <button type="button" class="btn btn-xs mb-1 btn-info"><i class='uil-users-alt me-1'></i>Manage Member</button>
                                            <button type="button" class="btn btn-xs mb-1 btn-dark"><i class='uil-pause me-1'></i>Hold</button>
                                            <button type="button" class="btn btn-xs mb-1 btn-success"><i class='mdi mdi-check-all me-1'></i>Complete</button>
                                            <button type="button" class="btn btn-xs mb-1 btn-danger"><i class='mdi mdi-cancel me-1'></i>Cancel</button>
                                              {% if members|length > 1 %}
                                              <hr>
                                              <button type="button" class="btn btn-xs mb-1 btn-outline-danger" onclick="leave_request()"><i class='uil-sign-out-alt me-1'></i>Leave</button>
                                              {% endif %}
                                            {% elif req.status == 'Complete' or status == 'Canceled' %}
                                            <button type="button" class="btn btn-xs mb-1 btn-info"><i class='uil-redo me-1'></i>Rework</button>
                                            {% endif %}
                                            {% if req.status == 'Rejected' %}
                                            <p class="text-center">There is no function for this request.</p>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>

                                <!-- ========== Team ========== -->
                                {% if req.status != 'Pending' and req.status != 'Rejected' %}
                                <div class="card">
                                    <div class="card-body pb-0">
                                        <div class="dropdown float-end">
                                        </div>

                                        <h4 class="header-title mb-3">Members ({{members|length}})</h4>

                                        <div class="inbox-widget">
                                            {% for member in members %}
                                            <div class="inbox-item">
                                                <p class="inbox-item-author">{{member.user.username}} | {{member.user.employee.name}}</p>
                                                <p class="inbox-item-text">Member</p>
                                            </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                {% endif %}

                            </div>
                        </div>
                        {% else %}
                        <!-- ========== Not Found ========== -->
                        <div class="row justify-content-center mt-5">
                            <div class="col-lg-4">
                                <div class="text-center">
                                    <img src="{% static "assets/images/file-searching.svg" %}" height="360" alt="File not found Image">
                                    <h2 class="text-uppercase text-danger mt-4">Request Not Found</h2>
                                    <h4 class="text-muted mt-1">{{request_no}}</h4>
                                </div>
                            </div>
                        </div>
                        {% endif %}
                    </div>

                    <!-- ========== Footer ========== -->
                    {% include 'footer.html' %}

                </div>
            </div>
        </div>

        <!-- ========== Right Side Bar ========== -->


        <!-- bundle -->
        <script src="{% static "assets/js/vendor.min.js" %}"></script>
        <script src="{% static "assets/js/app.min.js" %}"></script>
        <script src="{% static "custom/custom.js" %}"></script>
        <script src="{% static "custom/topsearch.js" %}"></script>
        <!-- DataTable -->
        <script src="{% static "assets/js/vendor/jquery.dataTables.min.js" %}"></script>
        <script src="{% static "assets/js/vendor/dataTables.bootstrap5.js" %}"></script>
        <script src="{% static "assets/js/vendor/dataTables.responsive.min.js" %}"></script>
        <script src="{% static "assets/js/vendor/responsive.bootstrap5.min.js" %}"></script>
        <script src="{% static "assets/js/vendor/dataTables.buttons.min.js" %}"></script>
        <script src="{% static "assets/js/vendor/buttons.bootstrap5.min.js" %}"></script>
        <script src="{% static "assets/js/vendor/buttons.html5.min.js" %}"></script>
        <script src="{% static "assets/js/vendor/buttons.flash.min.js" %}"></script>
        <script src="{% static "assets/js/vendor/buttons.print.min.js" %}"></script>
        <script src="{% static "assets/js/vendor/dataTables.keyTable.min.js" %}"></script>
        <script src="{% static "assets/js/vendor/dataTables.select.min.js" %}"></script>
        <script src="{% static "assets/js/vendor/fixedColumns.bootstrap5.min.js" %}"></script>
        <script src="{% static "assets/js/vendor/fixedHeader.bootstrap5.min.js" %}"></script>

        <script>
          $('#basic-datatable').DataTable( {
              "order": [[ 0, "asc" ]],
              'iDisplayLength': 100,
              "scrollX": true,
              dom: 'Bfrtip',
              buttons: [
                // 'excelHtml5',
                // 'csvHtml5',
              ]
          });

          function post_comment(){
            var req_id = $("#req_id").val();
            var comment_text = $("#comment_text").val();
            if(comment_text.length > 0){
              $.ajax({
                url: '/post_comment/',
                data: {
                  'req_id': req_id,
                  'comment_text': comment_text,
                },
                dataType: 'json',
                success: function (data) {
                  location.reload();
                }
              });
            }
          }

          function join_request(){
            var req_id = $("#req_id").val();
            $.ajax({
              url: '/join_request/',
              data: {
                'req_id': req_id,
              },
              dataType: 'json',
              success: function (data) {
                location.reload();
              }
            });
          }

          function leave_request(){
            var req_id = $("#req_id").val();
            $.ajax({
              url: '/leave_request/',
              data: {
                'req_id': req_id,
              },
              dataType: 'json',
              success: function (data) {
                location.reload();
              }
            });
          }
        </script>

    </body>
</html>
